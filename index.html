<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chubby Cattle Tip Out</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      background: #f9f9f9;
      color: #333;
      margin: 0;
      padding: 0;
    }

    .container {
      max-width: 600px;
      margin: 20px auto;
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    h1 {
      text-align: center;
      font-size: 28px;
      color: #444;
      margin-bottom: 20px;
    }

    label {
      font-weight: bold;
      margin: 10px 0 5px;
      display: block;
    }

    input[type="text"], input[type="number"], select {
      width: 100%;
      padding: 12px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 16px;
    }

    input[readonly] {
      background-color: #f1f1f1;
    }

    .signature-box {
      border: 2px dashed #ccc;
      background-color: #f9f9f9;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 200px;
      border-radius: 5px;
      position: relative;
      overflow: hidden;
    }

    .signature-box canvas {
      width: 100%;
      height: 100%;
      border-radius: 5px;
      touch-action: none;
    }

    .note {
      font-size: 14px;
      color: #666;
      margin-top: 20px;
      line-height: 1.6;
      text-align: justify;
    }

    .clear-btn, .save-btn {
      display: inline-block;
      margin-top: 10px;
      background-color: #5cb85c;
      color: white;
      padding: 10px 20px;
      border: none;
      cursor: pointer;
      border-radius: 5px;
      font-size: 14px;
      text-align: center;
    }

    .clear-btn:hover, .save-btn:hover {
      background-color: #4cae4c;
    }

    @media (max-width: 768px) {
      .container {
        margin: 10px;
        padding: 15px;
      }

      h1 {
        font-size: 24px;
      }

      .clear-btn, .save-btn {
        width: 100%;
      }
    }
  </style>
</head>
<body>

<div class="container" id="form-container">
  <h1>Chubby Cattle Tip Out</h1>

  <!-- Form Fields -->
  <label>Date (##/##/####)</label>
  <input type="text" id="date" placeholder="MM/DD/YYYY">

  <label>Server Name</label>
  <input type="text" id="server-name">

  <label>Section</label>
  <input type="text" id="section">

  <label>Total Guests #</label>
  <input type="number" id="total-guests">

  <label>Total Net Sales</label>
  <input type="number" id="total-net-sales" oninput="updateCalculations()">

  <label>Total CC Tips</label>
  <input type="number" id="total-cc-tips" oninput="updateCalculations()">

  <label>Total Cash Tips</label>
  <input type="number" id="total-cash-tips" oninput="updateCalculations()">

  <label>Total Tips</label>
  <input type="number" id="total-tips" readonly>

  <label>Tip Percentage from Net Sales</label>
  <input type="text" id="tip-percentage" readonly>

  <label>NET FOOD SALES</label>
  <input type="number" id="net-food-sales" oninput="updateCalculations()">

  <label>Total Tip Out 10.5% of NET FOOD SALES</label>
  <input type="text" id="total-tip-out" readonly>

  <label>Total Tip Out 0.5% to Captain</label>
  <select id="captain-tip-out" onchange="updateCalculations()">
    <option value="No">No</option>
    <option value="Yes">Yes</option>
  </select>

  <label>Captain Tip Out</label>
  <input type="text" id="captain-tip-out-amount" readonly>

  <!-- Signature Areas -->
  <label>Server Signature (Tap to sign)</label>
  <div class="signature-box">
    <canvas id="server-signature-canvas"></canvas>
  </div>
  <button class="clear-btn" onclick="clearCanvas('server-signature-canvas')">Clear Signature</button>

  <label>Manager Signature (Tap to sign)</label>
  <div class="signature-box">
    <canvas id="manager-signature-canvas"></canvas>
  </div>
  <button class="clear-btn" onclick="clearCanvas('manager-signature-canvas')">Clear Signature</button>

  <!-- Submit Button -->
  <button class="save-btn" onclick="submitForm()">Submit Form</button>

  <p class="note">
    Note: This is a document used for payroll and tax purposes, this form must be filled out accurately and completely. All employees receiving tips must verify the tip amount received by initiating this form. As the Server, you are responsible for completing all information contained in this document. This means you must obtain the names of all employees who worked and will receive tips in each department listed. Forging or incorrectly completing this document will NOT be tolerated.
  </p>
</div>

<script>
  async function submitForm() {
    const formData = {
      date: document.getElementById('date').value,
      serverName: document.getElementById('server-name').value,
      section: document.getElementById('section').value,
      totalGuests: parseInt(document.getElementById('total-guests').value) || 0,
      totalNetSales: parseFloat(document.getElementById('total-net-sales').value) || 0,
      totalCCTips: parseFloat(document.getElementById('total-cc-tips').value) || 0,
      totalCashTips: parseFloat(document.getElementById('total-cash-tips').value) || 0,
      totalTips: parseFloat(document.getElementById('total-tips').value) || 0,
      tipPercentage: document.getElementById('tip-percentage').value,
      netFoodSales: parseFloat(document.getElementById('net-food-sales').value) || 0,
      totalTipOut: parseFloat(document.getElementById('total-tip-out').value) || 0,
      captainTipOut: parseFloat(document.getElementById('captain-tip-out-amount').value) || 0,
    };

    try {
      const response = await fetch('YOUR_GOOGLE_APPS_SCRIPT_URL', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(formData),
      });
      const result = await response.json();
      if (result.status === 'success') {
        alert('Form submitted successfully!');
      } else {
        alert('Failed to submit form.');
      }
    } catch (error) {
      console.error('Error submitting form:', error);
    }
  }

  function updateCalculations() {
    const ccTips = parseFloat(document.getElementById('total-cc-tips').value) || 0;
    const cashTips = parseFloat(document.getElementById('total-cash-tips').value) || 0;
    const totalTips = ccTips + cashTips;
    document.getElementById('total-tips').value = totalTips.toFixed(2);

    const netSales = parseFloat(document.getElementById('total-net-sales').value) || 0;
    document.getElementById('tip-percentage').value = netSales ? ((totalTips / netSales) * 100).toFixed(2) + '%' : '0%';

    const netFoodSales = parseFloat(document.getElementById('net-food-sales').value) || 0;
    document.getElementById('total-tip-out').value = (netFoodSales * 0.105).toFixed(2);

    const captainChoice = document.getElementById('captain-tip-out').value;
    document.getElementById('captain-tip-out-amount').value = captainChoice === 'Yes' ? (netFoodSales * 0.005).toFixed(2) : '0.00';
  }

  function initSignatureCanvas(canvasId) {
    const canvas = document.getElementById(canvasId);
    const context = canvas.getContext('2d');
    let drawing = false;

    canvas.width = canvas.offsetWidth;
    canvas.height = canvas.offsetHeight;

    canvas.addEventListener('mousedown', (e) => {
      drawing = true;
      context.moveTo(e.offsetX, e.offsetY);
      context.beginPath();
    });

    canvas.addEventListener('mousemove', (e) => {
      if (drawing) {
        context.lineTo(e.offsetX, e.offsetY);
        context.stroke();
      }
    });

    canvas.addEventListener('mouseup', () => {
      drawing = false;
    });

    canvas.addEventListener('touchstart', (e) => {
      drawing = true;
      const rect = canvas.getBoundingClientRect();
      context.moveTo(e.touches[0].clientX - rect.left, e.touches[0].clientY - rect.top);
      context.beginPath();
    });

    canvas.addEventListener('touchmove', (e) => {
      if (drawing) {
        const rect = canvas.getBoundingClientRect();
        context.lineTo(e.touches[0].clientX - rect.left, e.touches[0].clientY - rect.top);
        context.stroke();
      }
    });

    canvas.addEventListener('touchend', () => {
      drawing = false;
    });
  }

  function clearCanvas(canvasId) {
    const canvas = document.getElementById(canvasId);
    const context = canvas.getContext('2d');
    context.clearRect(0, 0, canvas.width, canvas.height);
  }

  window.onload = function() {
    initSignatureCanvas('server-signature-canvas');
    initSignatureCanvas('manager-signature-canvas');
  };
</script>
</body>
</html>
